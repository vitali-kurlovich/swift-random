//
//  SHA512RandomGenegatorTests.swift
//  swift-random
//
//  Created by Vitali Kurlovich on 30.03.25.
//

import Foundation
import Random
import Testing

@Test("SHA512 Seed 0")
func SHA512_Seed_0() {
    var generator = SHA512RandomGenegator(seed: 0)

    let result = (0 ..< 32).map { _ in generator.next() }

    let expected: [UInt64] = [0x4DA3_D5F0_CC09_741B, 0x74E2_9FFA_ABEA_773A, 0xEE27_7129_E95B_6527, 0x4F6D_04F4_1BAA_2295, 0x1ACB_6981_6783_5994, 0xD9F0_7EC4_CAED_4873, 0x5FCC_5B0E_1324_C9E2, 0x1B2F_C452_7893_940D, 0x1557_EF1C_7617_F1D6, 0xBB2E_CFA3_49FE_B3FC, 0x1E7A_D8E9_C9CE_8A26, 0x21D_1A81_AAA8_1288, 0x164C_6904_9D6B_63ED, 0xC2D_7787_E671_D00F, 0x5443_A40D_99C3_E1C2, 0x32A6_7FB8_F7B1_C709, 0x2739_3623_3ECC_4099, 0xA4E5_2BE2_927E_B3DE, 0x54F7_F794_9289_290D, 0x2664_9B3E_77B3_78E3, 0xCF28_0E13_D28C_F3B4, 0x52E9_9BE6_EEC5_88FF, 0x80D7_D2D8_6E1A_4C5B, 0x6E1_5CE1_ADEF_A629, 0x50C5_63AE_42F2_DFBE, 0x1B9B_DE8D_1F19_467C, 0x8F0B_CFDE_BB8D_FF10, 0xE7DD_E861_8ED1_36D5, 0xAC85_8A1D_EF49_A4E7, 0x214E_B488_601A_6839, 0x70F1_9EB1_0855_0BB9, 0x1B99_43B1_6673_B1FF]

    #expect(result == expected)
}

@Test("SHA512 Seed 4598763")
func SHA512_Seed_4598763() {
    var generator = SHA512RandomGenegator(seed: 4_598_763)

    let result = (0 ..< 32).map { _ in generator.next() }

    let expected: [UInt64] = [0x320_6FCC_788D_EC98, 0x744C_C9D3_8028_0803, 0xFC28_43DA_240B_2F01, 0x349F_68CF_DED1_AA74, 0x564_6ECD_7FBA_8970, 0x5971_0A6A_12C0_61F7, 0x805C_2B7A_3501_B9AB, 0xF395_BA7A_8F4E_372B, 0x8EE_A605_52D0_EFF5, 0x2079_EBC9_B59D_3BB6, 0x1CAE_A902_A739_807C, 0x404A_CD2D_829B_F83A, 0x2196_0C2E_4E4F_04A1, 0x791A_2E02_17B8_1411, 0x9239_F615_9D37_0C89, 0x2D44_ADEF_BA41_2A9B, 0xA300_424E_256B_B06A, 0xDEB_9318_8C1E_F0B3, 0xD1E4_0D3F_0109_D4DF, 0xBF47_5522_895E_D790, 0xCEA7_B05C_D45E_4B50, 0x390_2D13_72B7_7D8E, 0x619F_DE9F_B4FB_36A3, 0xB10E_7CA9_08B5_DEEA, 0xAF2E_8944_58FB_20EB, 0x3CC_345F_47EB_F543, 0x519B_88AC_DC48_F62A, 0xEBC9_25CC_FA45_597C, 0xAB22_4EAC_A40C_4C16, 0xF4F7_C579_3DAC_C32C, 0x266D_3D3F_2104_22B9, 0x402F_F34E_229D_70F2]

    #expect(result == expected)
}

@Test("SHA512 Seed UUID")
func SHA512_UUID() {
    let uuid = UUID(uuidString: "4A442C1E-93F6-4196-9087-0834A0EFAE7D")!
    var generator = SHA512RandomGenegator(uuid: uuid)

    let result = (0 ..< 32).map { _ in generator.next() }

    let expected: [UInt64] = [0x701B_2E30_A77A_78D5, 0xAE38_54E1_5AF9_D3A7, 0xED50_F2B9_9CBE_CA2F, 0x88D_AAF8_12EB_98AD, 0xF7F7_5163_7D8F_DA13, 0x1626_A819_B50F_16FC, 0xF6C3_D2A4_AD69_AEA5, 0xCF18_3C3A_E2F0_1142, 0xC7BC_78A1_CC3E_D6A2, 0x2F7A_E15C_9BD9_A3F4, 0xC088_4CF5_B46F_EC53, 0xD297_98DC_67D8_C874, 0x55E6_D2FA_E607_2177, 0x49CC_D949_5814_8729, 0xED7D_AC4A_88A4_98DD, 0x9B36_735E_4551_89BF, 0xD8B7_9D10_D4C4_4D69, 0x5BFD_FBE4_6181_A580, 0x5C52_5BD0_178F_4657, 0xB7CA_3AA1_D2E8_301B, 0x82A9_BBD6_DA16_3C3E, 0x477_62C8_7E53_28D5, 0xC7BB_F8EA_DA10_8DA8, 0x7AB2_C050_30C9_BF85, 0xAA20_86AC_FA02_4B53, 0xC28C_CFC0_C877_D84A, 0xCEBA_A70B_20ED_646D, 0x8E70_3940_22E7_ED52, 0xAB8A_0513_8CCA_3408, 0x46F1_EBA3_A81D_8B84, 0xF4A6_DDD2_08C8_697F, 0xF2F3_2286_C690_FB7C]

    #expect(result == expected)
}
